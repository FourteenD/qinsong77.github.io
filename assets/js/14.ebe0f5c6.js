(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{523:function(s,t,a){s.exports=a.p+"assets/img/monorepo.cf20a6bb.png"},524:function(s,t,a){s.exports=a.p+"assets/img/monorepovsMutirepo.ff1c7850.png"},525:function(s,t,a){s.exports=a.p+"assets/img/babel.069cab4f.png"},526:function(s,t,a){s.exports=a.p+"assets/img/babel_Architecture.9b14a324.png"},527:function(s,t,a){s.exports=a.p+"assets/img/babel_process.c3eef89a.png"},528:function(s,t,a){s.exports=a.p+"assets/img/babe_tool_package.8f7dee83.png"},529:function(s,t,a){s.exports=a.p+"assets/img/core_js.76b267d6.png"},530:function(s,t,a){s.exports=a.p+"assets/img/webpack_progress.e3d06fa6.png"},631:function(s,t,a){"use strict";a.r(t);var n=a(25),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("ul",[n("li",[n("a",{attrs:{href:"#%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96"}},[s._v("前端工程化")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#monorepo"}},[s._v("Monorepo")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#babel"}},[s._v("Babel")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#postcss"}},[s._v("postcss")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#%E7%AE%80%E8%BF%B0webpack%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"}},[s._v("webpack工作流程")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#%E6%89%93%E5%8C%85%E8%BF%87%E7%A8%8B"}},[s._v("打包过程")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#%E5%B8%B8%E7%94%A8loader"}},[s._v("常用loader")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#%E5%B8%B8%E7%94%A8plugin"}},[s._v("常用plugin")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#%E7%83%AD%E6%9B%B4%E6%96%B0"}},[s._v("热更新")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#_3%E7%A7%8Dhash"}},[s._v("3种hash")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#code-splitting"}},[s._v("Code Splitting")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#%E9%A1%B9%E7%9B%AE%E4%B8%AD-%E4%BD%A0%E4%BD%BF%E7%94%A8-webpack-%E5%81%9A%E4%BA%86%E5%93%AA%E4%BA%9B%E4%BC%98%E5%8C%96"}},[s._v("项目中-你使用-webpack-做了哪些优化")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#%E7%BC%96%E5%86%99loader"}},[s._v("编写loader")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#%E7%BC%96%E5%86%99%E6%8F%92%E4%BB%B6"}},[s._v("编写插件")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#tree-shaking"}},[s._v("Tree Shaking")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#webpack%E6%A8%A1%E5%9D%97%E6%89%93%E5%8C%85%E5%8E%9F%E7%90%86"}},[s._v("Webpack模块加载打包原理")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#require-context%E6%98%AF%E4%BB%80%E4%B9%88"}},[s._v("require.context是什么")])]),s._v(" "),n("li",[n("a",{attrs:{href:"#sourcemap"}},[s._v("SourceMap")])])]),s._v(" "),n("h2",{attrs:{id:"文章合集"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#文章合集"}},[s._v("#")]),s._v(" 文章合集")]),s._v(" "),n("h4",{attrs:{id:"webpack-中那些最易混淆的-5-个知识点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webpack-中那些最易混淆的-5-个知识点"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://juejin.cn/post/6844904007362674701",target:"_blank",rel:"noopener noreferrer"}},[s._v("webpack 中那些最易混淆的 5 个知识点"),n("OutboundLink")],1)]),s._v(" "),n("h4",{attrs:{id:"webpack4打包机制原理解析"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webpack4打包机制原理解析"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://mp.weixin.qq.com/s/WXUW4bS4nT90uycodN0avw",target:"_blank",rel:"noopener noreferrer"}},[s._v("Webpack4打包机制原理解析"),n("OutboundLink")],1)]),s._v(" "),n("h4",{attrs:{id:"webpack面试题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webpack面试题"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://juejin.cn/post/6844904094281236487",target:"_blank",rel:"noopener noreferrer"}},[s._v("Webpack面试题"),n("OutboundLink")],1)]),s._v(" "),n("h4",{attrs:{id:"从源码窥探webpack4-x原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#从源码窥探webpack4-x原理"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://juejin.cn/post/6844904046294204429",target:"_blank",rel:"noopener noreferrer"}},[s._v("从源码窥探Webpack4.x原理"),n("OutboundLink")],1)]),s._v(" "),n("h4",{attrs:{id:"webpack小书"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webpack小书"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://www.timsrc.com/article/2/webpack-book",target:"_blank",rel:"noopener noreferrer"}},[s._v("webpack小书"),n("OutboundLink")],1)]),s._v(" "),n("h4",{attrs:{id:"webpack揭秘"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webpack揭秘"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://juejin.cn/post/6844903685407916039",target:"_blank",rel:"noopener noreferrer"}},[s._v("Webpack揭秘"),n("OutboundLink")],1)]),s._v(" "),n("h4",{attrs:{id:"由浅入深配置webpack4"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#由浅入深配置webpack4"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://juejin.im/post/6859888538004783118",target:"_blank",rel:"noopener noreferrer"}},[s._v("由浅入深配置webpack4"),n("OutboundLink")],1)]),s._v(" "),n("h4",{attrs:{id:"手写webpack核心原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#手写webpack核心原理"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://juejin.im/post/6854573217336541192",target:"_blank",rel:"noopener noreferrer"}},[s._v("手写webpack核心原理"),n("OutboundLink")],1)]),s._v(" "),n("h4",{attrs:{id:"体积减少80-释放webpack-tree-shaking的真正潜力"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#体积减少80-释放webpack-tree-shaking的真正潜力"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://juejin.cn/post/6844903769646317576",target:"_blank",rel:"noopener noreferrer"}},[s._v("体积减少80%！释放webpack tree-shaking的真正潜力"),n("OutboundLink")],1)]),s._v(" "),n("h4",{attrs:{id:"vite-原理分析"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite-原理分析"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://juejin.cn/post/6881078539756503047",target:"_blank",rel:"noopener noreferrer"}},[s._v("Vite 原理分析"),n("OutboundLink")],1)]),s._v(" "),n("h4",{attrs:{id:"前端-dsl-实践指南"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前端-dsl-实践指南"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/107947462",target:"_blank",rel:"noopener noreferrer"}},[s._v("前端 DSL 实践指南"),n("OutboundLink")],1)]),s._v(" "),n("h3",{attrs:{id:"前端工程化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前端工程化"}},[s._v("#")]),s._v(" 前端工程化")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/276458191",target:"_blank",rel:"noopener noreferrer"}},[s._v("手把手带你入门前端工程化——超详细教程"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://juejin.cn/post/6844904132512317453",target:"_blank",rel:"noopener noreferrer"}},[s._v("前端工程化"),n("OutboundLink")],1)])]),s._v(" "),n("p",[s._v("前端工程化可以分成四个方面来说，分别为模块化、组件化、规范化和自动化。")]),s._v(" "),n("h4",{attrs:{id:"模块化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#模块化"}},[s._v("#")]),s._v(" 模块化")]),s._v(" "),n("p",[s._v("模块化是指将一个文件拆分成多个相互依赖的文件，最后进行统一的打包和加载，这样能够很好的保证高效的多人协作。其中包含")]),s._v(" "),n("ul",[n("li",[s._v("JS 模块化：CommonJS、AMD、CMD 以及 ES6 Module。")]),s._v(" "),n("li",[s._v("CSS 模块化：Sass、Less、Stylus、"),n("a",{attrs:{href:"https://www.bemcss.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("BEM"),n("OutboundLink")],1),s._v("（"),n("code",[s._v("即模块名 + 元素名 + 修饰器名")]),s._v("。）、CSS Modules 等。其中预处理器和 BEM 都会有的一个问题就是样式覆盖。而 CSS Modules 则是通过 JS 来管理依赖，最大化的结合了 JS 模块化和 CSS 生态，比如 Vue 中的 style scoped。")]),s._v(" "),n("li",[s._v("资源模块化：任何资源都能以模块的形式进行加载，目前大部分项目中的文件、CSS、图片等都能直接通过 JS 做统一的依赖关系处理。")])]),s._v(" "),n("h4",{attrs:{id:"组件化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#组件化"}},[s._v("#")]),s._v(" 组件化")]),s._v(" "),n("p",[s._v("不同于模块化，模块化是对文件、对代码和资源拆分，而组件化则是对 UI 层面的拆分。\n通常，我们会需要对页面进行拆分，将其拆分成一个一个的零件，然后分别去实现这一个个零件，最后再进行组装。\n在我们的实际业务开发中，对于组件的拆分我们需要做不同程度的考量，其中主要包括细粒度和通用性这两块的考虑。\n对于业务组件，你更多需要考量的是针对你负责业务线的一个适用度，即你设计的业务组件是否成为你当前业务的 “通用” 组件。")]),s._v(" "),n("h4",{attrs:{id:"规范化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#规范化"}},[s._v("#")]),s._v(" 规范化")]),s._v(" "),n("p",[s._v("正所谓无规矩不成方圆，一些好的规范则能很好的帮助我们对项目进行良好的开发管理。规范化指的是我们在工程开发初期以及开发期间制定的系列规范，其中又包含了")]),s._v(" "),n("ul",[n("li",[s._v("项目目录结构")]),s._v(" "),n("li",[s._v("编码规范：对于编码这块的约束，一般我们都会采用一些强制措施，比如 ESLint、StyleLint 等。")]),s._v(" "),n("li",[s._v("联调规范")]),s._v(" "),n("li",[s._v("文件命名规范")]),s._v(" "),n("li",[s._v("样式管理规范：目前流行的样式管理有 BEM、Sass、Less、Stylus、CSS Modules 等方式。")]),s._v(" "),n("li",[s._v("git flow 工作流：其中包含分支命名规范、代码合并规范等。")]),s._v(" "),n("li",[s._v("定期 code review")]),s._v(" "),n("li",[s._v("… 等等")])]),s._v(" "),n("h4",{attrs:{id:"自动化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#自动化"}},[s._v("#")]),s._v(" 自动化")]),s._v(" "),n("p",[s._v("从最早先的 grunt、gulp 等，再到目前的 webpack、parcel。这些自动化工具在自动化合并、构建、打包都能为我们节省很多工作。而这些只是前端自动化其中的一部分，前端自动化还包含了持续集成、自动化测试等方方面面。")]),s._v(" "),n("h3",{attrs:{id:"monorepo"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#monorepo"}},[s._v("#")]),s._v(" Monorepo")]),s._v(" "),n("p",[s._v("总结作用")]),s._v(" "),n("ol",[n("li",[s._v("单仓库实现将各包统一收敛在packages中，在上层统一统筹管理各个package的依赖、构建、开发/调试、测试、版本、发布，提供更优雅的多包管理和协作方案。")]),s._v(" "),n("li",[s._v("用于单仓库多项目管理，组件页面复用，代码规范统一。")])]),s._v(" "),n("p",[s._v("Monorepo 的全称是 monolithic repository，即单体式仓库，与之对应的是 Multirepo(multiple repository)，这里的“单”和“多”是指每个仓库中所管理的模块数量。")]),s._v(" "),n("p",[s._v("Monorepo就是把"),n("strong",[s._v("多个项目放在一个仓库里面")]),s._v("，相对立的是传统的 "),n("code",[s._v("MultiRepo")]),s._v(" 模式，即每个项目对应一个单独的仓库来分散管理。")]),s._v(" "),n("p",[s._v("Monorepo解决了：")]),s._v(" "),n("ol",[n("li",[s._v("代码复用")]),s._v(" "),n("li",[s._v("版本管理")]),s._v(" "),n("li",[s._v("项目基建：由于在 MultiRepo 当中，各个项目的工作流是割裂的，因此每个项目需要单独配置开发环境、配置 CI 流程、配置部署发布流程等等，甚至每个项目都有自己单独的一套脚手架工具。")])]),s._v(" "),n("h4",{attrs:{id:"收益"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#收益"}},[s._v("#")]),s._v(" 收益")]),s._v(" "),n("ol",[n("li",[s._v("首先是"),n("strong",[s._v("工作流的一致性")]),s._v("，由于所有的项目放在一个仓库当中，复用起来非常方便，如果有依赖的代码变动，那么用到这个依赖的项目当中会立马感知到。并且所有的项目都是使用最新的代码，不会产生其它项目版本更新不及时的情况。")]),s._v(" "),n("li",[s._v("其次是"),n("strong",[s._v("项目基建成本的降低")]),s._v("，所有项目复用一套标准的工具和规范，无需切换开发环境，如果有新的项目接入，也可以直接复用已有的基建流程，比如 CI 流程、构建和发布流程。这样只需要很少的人来维护所有项目的基建，维护成本也大大减低。")]),s._v(" "),n("li",[s._v("再者，"),n("strong",[s._v("团队协作也更加容易")]),s._v("，一方面大家都在一个仓库开发，能够方便地共享和复用代码，方便检索项目源码，另一方面，git commit 的历史记录也支持以功能为单位进行提交，之前对于某个功能的提交，需要改好几个仓库，提交多个 commit，现在只需要提交一次，简化了 commit 记录，方便协作。")])]),s._v(" "),n("p",[n("img",{attrs:{src:a(523),alt:""}})]),s._v(" "),n("p",[n("img",{attrs:{src:a(524),alt:""}})]),s._v(" "),n("h4",{attrs:{id:"lerna"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#lerna"}},[s._v("#")]),s._v(" lerna")]),s._v(" "),n("p",[s._v("A tool for managing JavaScript projects with multiple packages.")]),s._v(" "),n("ul",[n("li",[s._v("使用yarn workspaces单纯的处理依赖问题。")]),s._v(" "),n("li",[s._v("用lerna来处理统筹管理package的问题。")])]),s._v(" "),n("ol",[n("li",[s._v("自动解决packages之间的依赖关系")]),s._v(" "),n("li",[s._v("通过 git 检测文件改动，自动发布")]),s._v(" "),n("li",[s._v("根据 git 提交记录，自动生成 CHANGELOG")])]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://mp.weixin.qq.com/s/Qf65Pk0t1n0L1s7Fv-XZewhttps://mp.weixin.qq.com/s/Qf65Pk0t1n0L1s7Fv-XZew",target:"_blank",rel:"noopener noreferrer"}},[s._v("彻底搞懂基于 Monorepo 的 lerna 模块"),n("OutboundLink")],1)])]),s._v(" "),n("h2",{attrs:{id:"babel"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#babel"}},[s._v("#")]),s._v(" Babel")]),s._v(" "),n("p",[n("strong",[s._v("Babel is a JavaScript compiler.")])]),s._v(" "),n("p",[s._v("Babel就是一个JavaScript编译器，babel编译分为三个阶段，"),n("strong",[s._v("解析（parse），转换（transform），生成（generate）")]),s._v("。\nBabel本身不支持转换，转换是通过一个个 plugin实现。")]),s._v(" "),n("p",[n("img",{attrs:{src:a(525),alt:""}})]),s._v(" "),n("p",[s._v("Babel的架构")]),s._v(" "),n("p",[n("img",{attrs:{src:a(526),alt:""}})]),s._v(" "),n("p",[n("a",{attrs:{href:"https://mp.weixin.qq.com/s/1OyBkl5NnFO1q86L7GjQwg",target:"_blank",rel:"noopener noreferrer"}},[s._v("Babel介绍"),n("OutboundLink")],1)]),s._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6844904008679686152",target:"_blank",rel:"noopener noreferrer"}},[s._v("Babel7"),n("OutboundLink")],1)]),s._v(" "),n("p",[n("a",{attrs:{href:"https://www.jianshu.com/p/e9b94b2d52e2",target:"_blank",rel:"noopener noreferrer"}},[s._v("深入理解Babel原理及其使用"),n("OutboundLink")],1)]),s._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6844903956905197576",target:"_blank",rel:"noopener noreferrer"}},[s._v("深入浅出 Babel"),n("OutboundLink")],1)]),s._v(" "),n("p",[n("img",{attrs:{src:a(527),alt:""}})]),s._v(" "),n("h4",{attrs:{id:"parse"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#parse"}},[s._v("#")]),s._v(" parse")]),s._v(" "),n("p",[s._v("分为"),n("strong",[s._v("词法解析")]),s._v("(Lexical Analysis)和"),n("strong",[s._v("语法解析")]),s._v("(Syntactic Analysis)")]),s._v(" "),n("p",[s._v("词法解析器(Tokenizer)在这个阶段将字符串形式的代码转换为Tokens(令牌). Tokens 可以视作是一些语法片段组成的数组， 每个 Token 中包含了语法片段、位置信息、以及一些类型信息. 这些信息有助于后续的语法分析。词法分析可以简单的理解为分词，利用存在的编程规则，进行匹配转换成token。")]),s._v(" "),n("p",[s._v("词法分析被抽象为了一个“有限状态自动机”，在某个状态下，满足一些条件后，会进行状态转移，转移到新的状态，从代码层面看，是一系列的 switch case 语句。经过词法分析后，代码被准确的切割，每个被切分的词叫做 "),n("code",[s._v("token")]),s._v("。")]),s._v(" "),n("p",[s._v("语法解析： 语法解析器(Parser)会把Tokens转换为抽象语法树(Abstract Syntax Tree，AST)，要做到语法分析，其实要做的就是对于语言要进行建模与抽象，就是一系列的规则的匹配与嵌套，优先级低的规则嵌套优先级高的规则（这样才能保证优先级高的先执行）")]),s._v(" "),n("h4",{attrs:{id:"transform"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#transform"}},[s._v("#")]),s._v(" transform")]),s._v(" "),n("p",[s._v("AST 遍历和转换会使用"),n("strong",[s._v("访问者模式")]),s._v("。访问者会以"),n("code",[s._v("深度优先")]),s._v("的顺序, 或者说"),n("code",[s._v("递归")]),s._v("地对 AST 进行遍历, "),n("code",[s._v("@babel/traverse")]),s._v("，实现了访问者模式，对 AST 进行遍历，"),n("strong",[s._v("转换插件")]),s._v("会通过它获取感兴趣的AST节点，对节点继续操作")]),s._v(" "),n("p",[n("img",{attrs:{src:a(528),alt:""}})]),s._v(" "),n("h4",{attrs:{id:"polyfill和runtime的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#polyfill和runtime的区别"}},[s._v("#")]),s._v(" polyfill和runtime的区别")]),s._v(" "),n("p",[n("code",[s._v("polyfil")]),s._v("l是会污染原来的全局环境的（因为新的原生对象、API这些都直接由polyfill引入到全局环境）。这样就很容易会发生冲突。对于库library来说，是供外部使用的，但外部的环境并不在library的可控范围。所以runtime就是解决这个问题的，避免全局污染。")]),s._v(" "),n("p",[s._v("babel-plugin-transform-runtime插件依赖babel-runtime，babel-runtime是真正提供runtime环境的包；也就是说transform-runtime插件是把js代码中使用到的新原生对象和静态方法转换成对runtime实现包的引用，举个例子如下：")]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 输入的ES6代码")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" sym "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Symbol")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 通过transform-runtime转换后的ES5+runtime代码 ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" _symbol "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"babel-runtime/core-js/symbol"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" sym "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _symbol"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("default"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("原本代码中使用的ES6新原生对象Symbol被transform-runtimec插件转换成了babel-runtime的实现，既保持了Symbol的功能，同时又没有像polyfill那样污染全局环境（因为最终生成的代码中，并没有对Symbol的引用）。")]),s._v(" "),n("h4",{attrs:{id:"transform-runtime插件的功能"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#transform-runtime插件的功能"}},[s._v("#")]),s._v(" transform-runtime插件的功能")]),s._v(" "),n("ol",[n("li",[s._v("把代码中的使用到的ES6引入的新原生对象和静态方法用babel-runtime/core-js导出的对象和方法替代")]),s._v(" "),n("li",[s._v("当使用generators或async函数时，用babel-runtime/regenerator导出的函数取代（类似polyfill分成regenerator和core-js两个部分）")]),s._v(" "),n("li",[s._v("把Babel生成的辅助函数改为用babel-runtime/helpers导出的函数来替代（babel默认会在每个文件顶部放置所需要的辅助函数，如果文件多的话，这些辅助函数就在每个文件中都重复了，通过引用babel-runtime/helpers就可以统一起来，减少代码体积）")])]),s._v(" "),n("p",[s._v("上述三点就是transform-runtime插件所做的事情，由此也可见，babel-runtime就是一个提供了regenerator、core-js和helpers的运行时库。\n建议不要直接使用babel-runtime，因为transform-runtime依赖babel-runtime，大部分情况下都可以用transform-runtime达成目的。")]),s._v(" "),n("h2",{attrs:{id:"core-js"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#core-js"}},[s._v("#")]),s._v(" core-js")]),s._v(" "),n("h3",{attrs:{id:"core-js介绍"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#core-js介绍"}},[s._v("#")]),s._v(" core-js介绍")]),s._v(" "),n("p",[s._v("其实core-js是我们能够使用新的API的最重要的包，然而一般情况它隐藏在webpack编译后的代码中，我们一般不会去查看，所以容易被遗忘，我们在webpack生成环境下，查看编译后的代码，可以看到例如includes就是从core-js导出到我们的代码去的。")]),s._v(" "),n("p",[n("img",{attrs:{src:a(529),alt:""}})]),s._v(" "),n("h4",{attrs:{id:"core-js是什么"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#core-js是什么"}},[s._v("#")]),s._v(" core-js是什么")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("它是JavaScript标准库的polyfill")])]),s._v(" "),n("li",[s._v("它尽可能的进行模块化，让你能选择你需要的功能")]),s._v(" "),n("li",[n("strong",[s._v("它可以不污染全局空间")])]),s._v(" "),n("li",[s._v("它和babel高度集成，可以对core-js的引入进行最大程度的优化")])]),s._v(" "),n("h3",{attrs:{id:"core-js-3-特性概览"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#core-js-3-特性概览"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://github.com/zloirock/core-js/blob/master/docs/2019-03-19-core-js-3-babel-and-a-look-into-the-future.md#babelpreset-env",target:"_blank",rel:"noopener noreferrer"}},[s._v("core-js@3 特性概览"),n("OutboundLink")],1)]),s._v(" "),n("ul",[n("li",[n("p",[s._v("支持ECMAScript稳定功能，引入core-js@3冻结期间的新功能，比如flat")])]),s._v(" "),n("li",[n("p",[s._v("加入到ES2016-ES2019中的提案，现在已经被标记为稳定功能")])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("更新了提案的实现，增加了proposals配置项，由于提案阶段不稳定，需要谨慎使用")])])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("增加了对一些web标准的支持，比如URL 和 URLSearchParams")])])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("现在支持原型方法，同时不污染原型")])])]),s._v(" "),n("li",[n("p",[s._v("删除了过时的特性")])])]),s._v(" "),n("h3",{attrs:{id:"core-js-3与babel"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#core-js-3与babel"}},[s._v("#")]),s._v(" core-js@3与babel")]),s._v(" "),n("p",[s._v("以前我们实现API的时候，会引入整个polyfill，其实polyfill只是包括了以下两个包")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("core-js")])]),s._v(" "),n("li",[n("code",[s._v("regenerator-runtime")]),s._v(": Standalone runtime for Regenerator-compiled generator and async functions.即"),n("code",[s._v("generator")]),s._v("和"),n("code",[s._v("async")]),s._v("的polyfill包")])]),s._v(" "),n("p",[n("code",[s._v("core-js@3")]),s._v("升级之后弃用了"),n("code",[s._v("@babel/polyfill")]),s._v("，以下是等价实现。polyfill是一个针对ES2015+环境的shim，实现上来说"),n("code",[s._v("babel-polyfill")]),s._v("包只是简单的把"),n("code",[s._v("core-js")]),s._v("和"),n("code",[s._v("regenerator runtime")]),s._v("包装了下。")]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// babel.config.js")]),s._v("\npresets"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"@babel/preset-env"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    useBuiltIns"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"entry"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// or "usage"')]),s._v("\n    corejs"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"core-js/stable"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"regenerator-runtime/runtime"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//  Standalone runtime for Regenerator-compiled generator and async functions. 解决generate和async的兼用问题")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h4",{attrs:{id:"vue-cli3下-browserslistrc文件含义"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue-cli3下-browserslistrc文件含义"}},[s._v("#")]),s._v(" vue/cli3下.browserslistrc文件含义")]),s._v(" "),n("p",[s._v("browserslist是用来配置项目的目标浏览器和nodejs版本范围，也就是通常说的兼容哪些浏览器的版本。")]),s._v(" "),n("ul",[n("li",[s._v('" >1%" :代表着全球超过1%人使用的浏览器')]),s._v(" "),n("li",[s._v("“last 2 versions” : 表示所有浏览器兼容到最后两个版本")]),s._v(" "),n("li",[s._v("“not ie <=8” :表示IE浏览器版本大于8（实则用npx browserslist 跑出来不包含IE9 ）")]),s._v(" "),n("li",[s._v("“safari >=7”:表示safari浏览器版本大于等于7")])]),s._v(" "),n("div",{staticClass:"language-.browserslistrc line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("> 1%\nlast 2 versions\nnot dead\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h5",{attrs:{id:"实现一个简单的按需打包功能babel插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实现一个简单的按需打包功能babel插件"}},[s._v("#")]),s._v(" 实现一个简单的按需打包功能babel插件")]),s._v(" "),n("p",[s._v("例如 "),n("code",[s._v("ElementUI")]),s._v(" 中把 "),n("code",[s._v("import { Button } from 'element-ui'")]),s._v(" 转成 "),n("code",[s._v("import Button from 'element-ui/lib/button'")])]),s._v(" "),n("p",[s._v("可以先对比下 "),n("code",[s._v("AST")]),s._v(" ：")]),s._v(" "),n("details",{staticClass:"custom-block details"},[n("summary",[s._v("点击查看代码")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('// import { Button } from \'element-ui\'\n{\n    "type": "Program",\n    "body": [\n        {\n            "type": "ImportDeclaration",\n            "specifiers": [\n                {\n                    "type": "ImportSpecifier",\n                    "local": {\n                        "type": "Identifier",\n                        "name": "Button"\n                    },\n                    "imported": {\n                        "type": "Identifier",\n                        "name": "Button"\n                    }\n                }\n            ],\n            "source": {\n                "type": "Literal",\n                "value": "element-ui",\n                "raw": "\'element-ui\'"\n            }\n        }\n    ],\n    "sourceType": "module"\n}\n\n// import Button from \'element-ui/lib/button\'\n{\n    "type": "Program",\n    "body": [\n        {\n            "type": "ImportDeclaration",\n            "specifiers": [\n                {\n                    "type": "ImportDefaultSpecifier",\n                    "local": {\n                        "type": "Identifier",\n                        "name": "Button"\n                    }\n                }\n            ],\n            "source": {\n                "type": "Literal",\n                "value": "element-ui/lib/button",\n                "raw": "\'element-ui/lib/button\'"\n            }\n        }\n    ],\n    "sourceType": "module"\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br")])])]),s._v(" "),n("p",[s._v("可以发现， "),n("code",[s._v("specifiers")]),s._v(" 的 "),n("code",[s._v("type")]),s._v(" 和 "),n("code",[s._v("source")]),s._v(" 的 "),n("code",[s._v("value")]),s._v("、"),n("code",[s._v("raw")]),s._v(" 不同。")]),s._v(" "),n("p",[s._v("然后 "),n("code",[s._v("ElementUI")]),s._v(" 官方文档中，"),n("code",[s._v("babel-plugin-component")]),s._v(" 的配置如下：")]),s._v(" "),n("details",{staticClass:"custom-block details"},[n("summary",[s._v("点击查看代码")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('// 如果 plugins 名称的前缀为 \'babel-plugin-\'，你可以省略 \'babel-plugin-\' 部分\n{\n  "presets": [["es2015", { "modules": false }]],\n  "plugins": [\n    [\n      "component",\n      {\n        "libraryName": "element-ui",\n        "styleLibraryName": "theme-chalk"\n      }\n    ]\n  ]\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" babel "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@babel/core'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" str "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("import { Button } from 'element-ui'")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" result "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" babel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("transform")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    plugins"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("types"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                visitor"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ImportDeclaration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" opts "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" node"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" specifiers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" source "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" path\n                        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 比较 source 的 value 值 与配置文件中的库名称")]),s._v("\n                        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("libraryName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" arr "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" specifiers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("map")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("specifier")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n                                t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("importDeclaration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n                                \n                                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ImportDefaultSpecifier")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("specifier"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("local"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                                    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 拼接详细路径")]),s._v("\n                                    t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("stringLiteral")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("/lib/")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("specifier"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("local"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("replaceWithMultiple")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("arr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// import Button from "element-ui/lib/Button";')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br")])])]),s._v(" "),n("h2",{attrs:{id:"postcss"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#postcss"}},[s._v("#")]),s._v(" postcss")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://mp.weixin.qq.com/s/TAKvKLXIG25gnuHSzt7Edg",target:"_blank",rel:"noopener noreferrer"}},[s._v("神奇的 postcss"),n("OutboundLink")],1)])]),s._v(" "),n("h2",{attrs:{id:"简述webpack工作流程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#简述webpack工作流程"}},[s._v("#")]),s._v(" 简述webpack工作流程")]),s._v(" "),n("h3",{attrs:{id:"概念"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#概念"}},[s._v("#")]),s._v(" 概念")]),s._v(" "),n("p",[n("strong",[s._v("Entry")]),s._v("：入口，Webpack 执行构建的第一步将从 Entry 开始，可抽象成输入。指示 webpack 应该使用哪个模块，来作为构建其内部 "),n("code",[s._v("依赖图(dependency graph)")]),s._v("的开始。进入入口起点后，webpack 会找出有哪些模块和库是入口起点（直接和间接）依赖的。\n默认值是 "),n("code",[s._v("./src/index.js")]),s._v("，但你可以通过在"),n("code",[s._v("webpack configuration")]),s._v("中配置 entry 属性，来指定一个（或多个）不同的入口起点。")]),s._v(" "),n("p",[n("strong",[s._v("Output")]),s._v("：输出结果，Output属性告诉 webpack 在哪里输出它所创建的 bundle，以及如何命名这些文件。主要输出文件的默认值是 "),n("code",[s._v("./dist/main.js")]),s._v("，其他生成文件默认放置在 "),n("code",[s._v("./dist")]),s._v("文件夹中。")]),s._v(" "),n("p",[n("strong",[s._v("Loader")]),s._v("：模块转换器，用于把模块原内容按照需求转换成新内容，webpack 只能理解 JavaScript 和 JSON 文件，loader 让 webpack 能够去处理其他类型的文件，并将它们转换为有效 模块，以供应用程序使用，以及被添加到依赖图中。\n在更高层面，在 webpack 的配置中，loader 有两个属性：1、"),n("code",[s._v("test")]),s._v(" 属性，识别出哪些文件会被转换。2、"),n("code",[s._v("use")]),s._v(" 属性，定义出在进行转换时，应该使用哪个 loader。\nLoader 本质上就是一个函数，对接收到的内容进行转换，返回转换后的结果。")]),s._v(" "),n("p",[n("strong",[s._v("Plugin")]),s._v("：扩展插件，loader 用于转换某些类型的模块，而插件则可以用于执行范围更广的任务。包括：打包优化，资源管理，注入环境变量。Plugin 就是在 Webpack 的生命周期中进行各种操作，从而达到使用者目的插件。")]),s._v(" "),n("p",[n("strong",[s._v("mode")]),s._v(": 模式，通过选择 development, production 或 none 之中的一个，来设置 mode 参数，可以启用 webpack 内置在相应环境下的优化。其默认值为 production。")]),s._v(" "),n("p",[n("strong",[s._v("Module")]),s._v("：模块，在 Webpack 里一切皆模块，一个模块对应着一个文件。Webpack 会从配置的 Entry 开始递归找出所有依赖的模块。")]),s._v(" "),n("p",[s._v("webpack 模块能以各种方式表达它们的依赖关系。下面是一些示例：")]),s._v(" "),n("ul",[n("li",[s._v("ES2015 "),n("code",[s._v("import")]),s._v(" 语句")]),s._v(" "),n("li",[s._v("CommonJS "),n("code",[s._v("require()")]),s._v(" 语句")]),s._v(" "),n("li",[s._v("AMD "),n("code",[s._v("define")]),s._v(" 和 "),n("code",[s._v("require")]),s._v(" 语句")]),s._v(" "),n("li",[s._v("css/sass/less 文件中的 "),n("code",[s._v("@import")]),s._v(" 语句。")]),s._v(" "),n("li",[s._v("stylesheet "),n("code",[s._v("url(...)")]),s._v(" 或者 HTML "),n("code",[s._v("<img src=...>")]),s._v("文件中的图片链接。")])]),s._v(" "),n("p",[n("strong",[s._v("Chunk")]),s._v("：代码块，一个 Chunk 由多个模块组合而成，用于代码合并与分割。")]),s._v(" "),n("p",[n("code",[s._v("Chunk")]),s._v("是代码块的意思，Webpack在执行构建的时候，会把多个模块合并为一个文件，该文件就称为"),n("code",[s._v("Chunk")]),s._v("。")]),s._v(" "),n("p",[s._v("Webpack 会为每个生成的 "),n("code",[s._v("Chunk")]),s._v(" 取一个名称，"),n("code",[s._v("Chunk")]),s._v(" 的名称和 "),n("code",[s._v("Entry")]),s._v(" 的配置有关：")]),s._v(" "),n("ul",[n("li",[s._v("如果 "),n("code",[s._v("entry")]),s._v(" 是一个 "),n("code",[s._v("string")]),s._v(" 或 "),n("code",[s._v("array")]),s._v("，就只会生成一个 "),n("code",[s._v("Chunk")]),s._v("，这时 "),n("code",[s._v("Chunk")]),s._v("的名称是 "),n("code",[s._v("main")]),s._v("；")]),s._v(" "),n("li",[s._v("如果 "),n("code",[s._v("entry")]),s._v(" 是一个 "),n("code",[s._v("object")]),s._v("，就可能会出现多个 "),n("code",[s._v("Chunk")]),s._v("，这时 "),n("code",[s._v("Chunk")]),s._v("的名称是 "),n("code",[s._v("object")]),s._v(" 键值对里键的名称。")])]),s._v(" "),n("h3",{attrs:{id:"构建过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#构建过程"}},[s._v("#")]),s._v(" 构建过程")]),s._v(" "),n("p",[s._v("关于 webpack 的工作流程，简单来说可以概括为以下几步：")]),s._v(" "),n("ul",[n("li",[s._v("（1）初始化参数")])]),s._v(" "),n("p",[s._v("解析 Webpack 配置参数，合并 "),n("code",[s._v("Shell")]),s._v(" 传入和 "),n("code",[s._v("webpack.config.js")]),s._v(" 文件配置的参数，形成最后的配置结果。")]),s._v(" "),n("ul",[n("li",[s._v("（2）开始编译")])]),s._v(" "),n("p",[s._v("上一步得到的参数初始化 "),n("code",[s._v("compiler")]),s._v(" 对象，注册所有配置的插件，插件监听 Webpack 构建生命周期的事件节点，做出相应的反应，执行对象的 run 方法开始执行编译。")]),s._v(" "),n("ul",[n("li",[s._v("（3）确定入口")])]),s._v(" "),n("p",[s._v("从配置文件（ "),n("code",[s._v("webpack.config.js")]),s._v(" ）中指定的 "),n("code",[s._v("entry")]),s._v(" 入口，开始解析文件构建 "),n("code",[s._v("AST")]),s._v(" 语法树，找出依赖，递归下去。")]),s._v(" "),n("ul",[n("li",[s._v("（4）编译模块")])]),s._v(" "),n("p",[s._v("递归中根据"),n("code",[s._v("文件类型")]),s._v("和 "),n("code",[s._v("loader")]),s._v(" 配置，调用所有配置的 "),n("code",[s._v("loader")]),s._v(" 对文件进行转换，再找出该模块依赖的模块，再递归本步骤直到所有入口依赖的文件都经过了本步骤的处理。")]),s._v(" "),n("ul",[n("li",[s._v("（5）完成模块编译并输出")])]),s._v(" "),n("p",[s._v("递归完后，得到每个文件结果，包含每个模块以及他们之间的依赖关系，根据 "),n("code",[s._v("entry")]),s._v(" 配置生成代码块 "),n("code",[s._v("chunk")]),s._v(" 。")]),s._v(" "),n("ul",[n("li",[s._v("（6）输出完成")])]),s._v(" "),n("p",[s._v("输出所有的 chunk 到文件系统。")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://mp.weixin.qq.com/s/NblP7A604kByp7pfdjcS0g",target:"_blank",rel:"noopener noreferrer"}},[s._v("简单实现"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("精简流程")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("初始化：启动构建，读取与合并配置参数，加载 Plugin，实例化 Compiler。")])]),s._v(" "),n("li",[n("p",[s._v("编译：从 Entry 发出，针对每个 Module 串行调用对应的 Loader 去翻译文件内容，再找到该 Module 依赖的 Module，递归地进行编译处理。")])]),s._v(" "),n("li",[n("p",[s._v("输出：对编译后的 Module 组合成 Chunk，把 Chunk 转换成文件，输出到文件系统。")])])]),s._v(" "),n("p",[n("img",{attrs:{src:a(530),alt:""}})]),s._v(" "),n("h3",{attrs:{id:"打包过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#打包过程"}},[s._v("#")]),s._v(" 打包过程")]),s._v(" "),n("p",[s._v("webpack的运行流程是一个串行的过程，从启动到结束会依次执行以下流程：")]),s._v(" "),n("ol",[n("li",[s._v("初始化参数")]),s._v(" "),n("li",[s._v("开始编译 用上一步得到的参数初始"),n("code",[s._v("Compiler")]),s._v("对象，加载所有配置的插件，通过执行对象的"),n("code",[s._v("run")]),s._v("方法开始执行编译")]),s._v(" "),n("li",[s._v("确定入口 根据配置中的 "),n("code",[s._v("Entry")]),s._v(" 找出所有入口文件")]),s._v(" "),n("li",[s._v("编译模块 从入口文件出发，调用所有配置的 "),n("code",[s._v("Loader")]),s._v(" 对模块进行编译，再找出该模块依赖的模块，再递归本步骤直到所有入口依赖的文件都经过了本步骤的处理")]),s._v(" "),n("li",[s._v("完成模块编译 在经过第4步使用 "),n("code",[s._v("Loader")]),s._v(" 翻译完所有模块后， 得到了每个模块被编译后的最终内容及它们之间的依赖关系")]),s._v(" "),n("li",[s._v("输出资源：根据入口和模块之间的依赖关系，组装成一个个包含多个模块的 "),n("code",[s._v("Chunk")]),s._v("，再将每个 "),n("code",[s._v("Chunk")]),s._v(" 转换成一个单独的文件加入输出列表中，这是可以修改输出内容的最后机会")]),s._v(" "),n("li",[s._v("输出完成：在确定好输出内容后，根据配置确定输出的路径和文件名，将文件的内容写入文件系统中。")])]),s._v(" "),n("p",[s._v("在以上过程中， Webpack 会在特定的时间点广播特定的事件，插件在监听到感兴趣的事件后会执行特定的逻辑，井且插件可以调用 Webpack 提供的 API 改变 Webpack 的运行结果。其实以上7个步骤，可以简单归纳为初始化、编译、输出，三个过程，而这个过程其实就是前面说的基本模型的扩展。")]),s._v(" "),n("h3",{attrs:{id:"常用loader"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常用loader"}},[s._v("#")]),s._v(" 常用loader")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("file-loader：把文件输出到一个文件夹中，在代码中通过相对 URL 去引用输出的文件，当引入的文件是 "),n("code",[s._v(".png")]),s._v("、"),n("code",[s._v(".txt")]),s._v("等时，可以通过 "),n("code",[s._v("file-loader")]),s._v(" 解析项目中的 "),n("code",[s._v("url")]),s._v("引入。根据配置将文件拷贝到相应的路径，并修改打包后文件的引入路径，让它指向正确的文件。;")])]),s._v(" "),n("li",[n("p",[s._v("url-loader："),n("code",[s._v("url-loader")]),s._v(" 封装了 "),n("code",[s._v("file-loader")]),s._v(" 且可以不依赖于 "),n("code",[s._v("file-loader")]),s._v(" 单独使用，并且可以配置 "),n("code",[s._v("limit")]),s._v("。对小于 limit 大小的图片转换成 "),n("code",[s._v("Base64")]),s._v("，大于 limit 的时候使用 file-loader 里的方法。")])]),s._v(" "),n("li",[n("p",[s._v("source-map-loader：加载额外的 Source Map 文件，以方便断点调试;")])]),s._v(" "),n("li",[n("p",[s._v("image-loader：加载并且压缩图片文件;")])]),s._v(" "),n("li",[n("p",[s._v("babel-loader：把 ES6 转换成 ES5;")])]),s._v(" "),n("li",[n("p",[s._v("css-loader：The css-loader interprets @import and url() like import/require() and will resolve them. 负责处理 "),n("code",[s._v("@import")]),s._v("、"),n("code",[s._v("url")]),s._v(" 等语句。例如 "),n("code",[s._v("import css from 'file.css'")]),s._v("、"),n("code",[s._v("url(image.png)")]),s._v("支持模块化、压缩、文件导入等特性；把 CSS 代码注入到 JavaScript 中")])]),s._v(" "),n("li",[n("p",[s._v("style-loader：Inject CSS into the DOM，在 DOM 里插入一个 "),n("code",[s._v("<style>")]),s._v(" 标签，并且将 CSS 写入这个标签内;")])]),s._v(" "),n("li",[n("p",[s._v("postcss-loader：负责进一步处理 CSS 文件，比如添加浏览器前缀，压缩 CSS 等。")])]),s._v(" "),n("li",[n("p",[s._v("less-loader：将 .less 文件内容转换成 CSS。")])]),s._v(" "),n("li",[n("p",[s._v("sass-loader：将 .sass 文件内容转换成 CSS。")])]),s._v(" "),n("li",[n("p",[s._v("eslint-loader：通过 ESLint 检查 JavaScript 代码;")])])]),s._v(" "),n("h3",{attrs:{id:"常用plugin"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常用plugin"}},[s._v("#")]),s._v(" 常用plugin")]),s._v(" "),n("ul",[n("li",[s._v("HotModuleReplacementPlugin：webpack内置的模块热更新插件。Hot-Module-Replacement 的热更新是依赖于 webpack-dev-server，后者是在打包文件改变时更新打包文件或者 reload 刷新整个页面，HRM 是只更新修改的部分。")]),s._v(" "),n("li",[s._v("clean-webpack-plugin：打包前自动清理 dist 目录，防止文件残留。")]),s._v(" "),n("li",[s._v("terser-webpack-plugin： Webpack4.0 默认是使用 terser-webpack-plugin 这个压缩插件")]),s._v(" "),n("li",[s._v("compression-webpack-plugin：gzip 压缩")]),s._v(" "),n("li",[s._v("copy-webpack-plugin：将单个文件或者整个目录复制到构建目录")]),s._v(" "),n("li",[s._v("mini-css-extract-plugin：将 CSS 抽离出来单独打包并且通过配置可以设置是否压缩。")]),s._v(" "),n("li",[s._v("html-webpack-plugin：这个插件可以配置生成一个 HTML5 文件，其中 script 标签包含所有 Webpack 包。如果你设置多个入口点，你可以据此实现多页面应用打包。")]),s._v(" "),n("li",[s._v("webpack-bundle-analyzer：打包分析插件")]),s._v(" "),n("li",[s._v("speed-measure-webpack-plugin: 打包速度分析，"),n("strong",[s._v("HardSourceWebpackPlugin 和 speed-measure-webpack-plugin 不能一起使用")])]),s._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/mzgoddard/hard-source-webpack-plugin",target:"_blank",rel:"noopener noreferrer"}},[s._v("hard-source-webpack-plugin"),n("OutboundLink")],1),s._v("（Webpack 4 的打包性能足够好的，dll继续维护的必要了, HardSourceWebpackPlugin is a plugin for webpack to provide an intermediate caching step for modules. In order to see results, you'll need to run webpack twice with this plugin: the first build will take the normal amount of time. The second build will be significantly faster.)")])]),s._v(" "),n("h3",{attrs:{id:"热更新"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#热更新"}},[s._v("#")]),s._v(" 热更新")]),s._v(" "),n("h4",{attrs:{id:"轻松理解webpack热更新原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#轻松理解webpack热更新原理"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://mp.weixin.qq.com/s/2L9Y0pdwTTmd8U2kXHFlPA",target:"_blank",rel:"noopener noreferrer"}},[s._v("轻松理解webpack热更新原理"),n("OutboundLink")],1)]),s._v(" "),n("h4",{attrs:{id:"了不起的-webpack-hmr-学习指南-含源码分析"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#了不起的-webpack-hmr-学习指南-含源码分析"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://mp.weixin.qq.com/s?__biz=MjM5MDc4MzgxNA==&mid=2458455505&idx=1&sn=b6d5258393b5c41b77cdc78299e94697&chksm=b1c22df886b5a4eed560aa9aa95bc27d473d58ebabb501ec98c282bdbc8308e9951cea59a060&scene=178&cur_album_id=1556921519803596802#rd",target:"_blank",rel:"noopener noreferrer"}},[s._v("了不起的 Webpack HMR 学习指南（含源码分析）"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("在 Webpack 的 webpack.config.js 中：")]),s._v(" "),n("ol",[n("li",[s._v("配置 devServer 的 hot 为 true")]),s._v(" "),n("li",[s._v("在 plugins 中增加 new webpack.HotModuleReplacementPlugin()")])]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// webpack.config.js")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" webpack "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'webpack'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//....")]),s._v("\n  devServer"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    hot"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  plugins"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("webpack"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("HotModuleReplacementPlugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 热更新插件")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("并且在入口文件配置：")]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("module "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hot"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hot"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("accept")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h4",{attrs:{id:"热更新原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#热更新原理"}},[s._v("#")]),s._v(" 热更新原理")]),s._v(" "),n("p",[n("code",[s._v("HMR")]),s._v("（Hot Module Replacement） 的核心就是客户端从服务端拉去更新后的文件，准确的说是 "),n("code",[s._v("chunk diff")]),s._v("（chunk 需要更新的部分）。\n实际上 "),n("code",[s._v("webpack-dev-server（WDS）")]),s._v("与浏览器之间维护了一个"),n("code",[s._v("Websocket")]),s._v("，当本地资源发生变化时，"),n("code",[s._v("WDS")]),s._v(" 会向浏览器推送更新，并带上构建时的 "),n("code",[s._v("hash")]),s._v("，让客户端与上一次资源进行对比。\n客户端对比出差异后会向 "),n("code",[s._v("WDS")]),s._v(" 发起"),n("code",[s._v("Ajax")]),s._v(" 请求来获取更改内容（文件列表、hash），这样客户端就可以再借助这些信息继续向 "),n("code",[s._v("WDS")]),s._v(" 发起 "),n("code",[s._v("jsonp")]),s._v(" 请求获取该 "),n("code",[s._v("chunk")]),s._v(" 的增量更新。\n后续的部分（拿到增量更新之后如何处理？哪些状态该保留？哪些又需要更新？）由 "),n("code",[s._v("HotModulePlugin")]),s._v(" 来完成，提供了相关 API 以供开发者针对自身场景进行处理，像 "),n("code",[s._v("react-hot-loader")]),s._v(" 和 "),n("code",[s._v("vue-loader")]),s._v(" 都是借助这些 API 实现 HMR。")]),s._v(" "),n("h3",{attrs:{id:"_3种hash"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3种hash"}},[s._v("#")]),s._v(" 3种hash")]),s._v(" "),n("p",[s._v("文件指纹是打包后输出的文件名的后缀，对应着 3 种 hash。")]),s._v(" "),n("ol",[n("li",[n("code",[s._v("hash")]),s._v("是跟整个项目的构建相关，只要项目里有文件更改，整个项目构建的 "),n("code",[s._v("hash")]),s._v(" 值都会更改，并且全部文件都共用相同的 "),n("code",[s._v("hash")]),s._v(" 值。（粒度: 整个项目）一旦只修改某一个文件，打包后就会造成所有文件的hash值都会改变，会导致未曾修改的文件的hash值变化，进一步会导致未修改的文件在浏览器的缓存失效了---不常用")]),s._v(" "),n("li",[n("code",[s._v("chunkhash")]),s._v("是根据不同的入口进行依赖文件解析，构建对应的 chunk（代码块），生成对应的 hash 值。只有被修改的 chunk 在重新构建之后才会生成新的 hash 值，不会影响其它的 chunk。如果在某一入口文件创建的关系依赖图上存在文件内容发生了变化，那么相应的入口文件的chunkhash才会发生变化，否则chunkhash就不会变化，所以chunkhash受它自身chunk的文件内容的影响，只要该chunk中的内容有变化，chunkhash就会变。（粒度:entry 的每个入口文件）因此一般在项目中会把公共库和其他文件拆开，并把公共库代码拆分到一起进行打包，因为公共库的代码变动较少，这样可以实现公共库的长效缓存。webpack4中支持了异步import功能，固，chunkhash也作用于此")]),s._v(" "),n("li",[n("code",[s._v("contenthash")]),s._v(" 是跟每个生成的文件有关，每个文件都有一个唯一的 hash 值。当要构建的文件内容发生改变时，就会生成新的 hash 值，且该文件的改变并不会影响和它同一个模块下的其它文件。（粒度: 每个文件的内容）\n使用chunkhash还存在一个问题，当一个JS文件引入了CSS文件（import 'xxx.css'），打包构建后它们的chunkhash值是相同的，因此如果更改了JS文件的内容，即使CSS文件内容没有更改，那么与这个JS关联的CSS文件的chunkhash也会跟着改变，这样就会导致未改变的CSS文件的缓存失效了。针对这种情况，我们可以使用mini-css-extract-plugin插件将CSS从JS文件中抽离出来并使用contenthash，来解决上述问题")])]),s._v(" "),n("p",[n("code",[s._v("filename")]),s._v(" 就是对应于 entry 里面的输入文件，经过webpack 打包后输出文件的文件名。指列在 "),n("code",[s._v("entry")]),s._v(" 中，打包后输出的文件的名称。")]),s._v(" "),n("p",[n("code",[s._v("chunkFilename")]),s._v(" 指未列在 entry 中，却又需要被打包出来的文件的名称。")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t    output"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// publicPath: './test',")]),s._v("\n            filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'js/[name].[hash].bundle.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            chunkFilename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'js/[name].[chunkhash].js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        plugins"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MiniCssExtractPlugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'css/[name].[contenthash].css'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                chunkFilename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'css/[name].[contenthash].css'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// new BundleAnalyzerPlugin(),")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CleanWebpackPlugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("h3",{attrs:{id:"code-splitting"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#code-splitting"}},[s._v("#")]),s._v(" Code Splitting")]),s._v(" "),n("p",[s._v("webpack 4 废弃了之前的不怎么好用的 "),n("code",[s._v("CommonsChunk")]),s._v("，取而代之的是 "),n("code",[s._v("SplitChunks")]),s._v("。")]),s._v(" "),n("p",[s._v("首先 webpack 总共提供了三种办法来实现 Code Splitting，如下：")]),s._v(" "),n("ul",[n("li",[s._v("入口配置：entry 入口使用多个入口文件；")]),s._v(" "),n("li",[s._v("抽取公有代码：使用 SplitChunks 抽取公有代码；")]),s._v(" "),n("li",[s._v("动态加载 ：动态加载一些代码。")])]),s._v(" "),n("h4",{attrs:{id:"splitchunks"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#splitchunks"}},[s._v("#")]),s._v(" SplitChunks")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://www.cnblogs.com/kwzm/p/10314438.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("理解webpack4.splitChunks"),n("OutboundLink")],1),s._v("\n默认配置")])]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[s._v("module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//...")]),s._v("\n  optimization"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    splitChunks"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      chunks"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'async'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 参数可能是：all，async和initial，这里表示拆分异步模块。")]),s._v("\n      minSize"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 如果模块的大小大于30kb，才会被拆分")]),s._v("\n      minChunks"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      maxAsyncRequests"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 按需加载时最大的请求数，意思就是说，如果拆得很小，就会超过这个值，限制拆分的数量。")]),s._v("\n      maxInitialRequests"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 入口处的最大请求数")]),s._v("\n      automaticNameDelimiter"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'~'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// webpack将使用块的名称和名称生成名称（例如vendors~main.js）")]),s._v("\n      name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 拆分块的名称")]),s._v("\n      cacheGroups"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 缓存splitchunks")]),s._v("\n        vendors"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          test"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("[\\\\/]node_modules[\\\\/]")]),n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          priority"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          minChunks"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 一个模块至少出现2次引用时，才会被拆分")]),s._v("\n          priority"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          reuseExistingChunk"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br")])]),n("p",[s._v("参数说明如下：")]),s._v(" "),n("ul",[n("li",[s._v("chunks：表示从哪些chunks里面抽取代码，除了三个可选字符串值 initial、async、all 之外，还可以通过函数来过滤所需的 chunks；")]),s._v(" "),n("li",[s._v("minSize：表示抽取出来的文件在压缩前的最小大小，默认为 30000；")]),s._v(" "),n("li",[s._v("maxSize：表示抽取出来的文件在压缩前的最大大小，默认为 0，表示不限制最大大小；")]),s._v(" "),n("li",[s._v("minChunks：表示被引用次数，默认为1；")]),s._v(" "),n("li",[s._v("maxAsyncRequests：最大的按需(异步)加载次数，默认为 5；")]),s._v(" "),n("li",[s._v("maxInitialRequests：最大的初始化加载次数，默认为 3；")]),s._v(" "),n("li",[s._v("automaticNameDelimiter：抽取出来的文件的自动生成名字的分割符，默认为 ~；")]),s._v(" "),n("li",[s._v("name：抽取出来文件的名字，默认为 true，表示自动生成文件名；")]),s._v(" "),n("li",[s._v("cacheGroups: 缓存组。（这才是配置的关键）")])]),s._v(" "),n("h4",{attrs:{id:"配置css文件压缩成一个"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置css文件压缩成一个"}},[s._v("#")]),s._v(" 配置css文件压缩成一个")]),s._v(" "),n("details",{staticClass:"custom-block details"},[n("summary",[s._v("点击查看代码")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("    config"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("optimization"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("splitChunks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      cacheGroups"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 将动态引入的css合并成一个css文件")]),s._v("\n        async"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'styles'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("test")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("m")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("constructor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'CssModule'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          chunks"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'all'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          minChunks"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          reuseExistingChunk"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          enforce"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])])]),s._v(" "),n("h4",{attrs:{id:"cachegroups"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cachegroups"}},[s._v("#")]),s._v(" cacheGroups")]),s._v(" "),n("p",[s._v("它可以继承/覆盖上面 splitChunks 中所有的参数值，除此之外还额外提供了三个配置，分别为：test, priority 和 reuseExistingChunk。")]),s._v(" "),n("ul",[n("li",[s._v("test: 表示要过滤 modules，默认为所有的 modules，可匹配模块路径或 chunk 名字，当匹配的是 chunk 名字的时候，其里面的所有 modules 都会选中；")]),s._v(" "),n("li",[s._v("priority：表示抽取权重，数字越大表示优先级越高。因为一个 module 可能会满足多个 cacheGroups 的条件，那么抽取到哪个就由权重最高的说了算；")]),s._v(" "),n("li",[s._v("reuseExistingChunk：表示是否使用已有的 chunk，如果为 true 则表示如果当前的 chunk 包含的模块已经被抽取出去了，那么将不会重新生成新的。")])]),s._v(" "),n("h3",{attrs:{id:"optimization-splitchunks-中-chunks-的3个值-all、async、initial-的含义"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#optimization-splitchunks-中-chunks-的3个值-all、async、initial-的含义"}},[s._v("#")]),s._v(" optimization.splitChunks 中，chunks 的3个值：all、async、initial 的含义")]),s._v(" "),n("ul",[n("li",[s._v("async表示只从异步加载得模块（动态加载import()）里面进行拆分")]),s._v(" "),n("li",[s._v("initial表示只从入口模块进行拆分")]),s._v(" "),n("li",[s._v("all表示以上两者都包括")])]),s._v(" "),n("p",[s._v("chunks有三个选项：initial、async和all。它指示应该优先分离同步（initial）、异步（async）还是所有的代码模块。这里的异步指的是通过动态加载方式（import()）加载的模块。")]),s._v(" "),n("p",[s._v("这里的重点是优先二字。以async为例，假如你有两个模块 a 和 b，两者都引用了 jQuery，但是 a 模块还通过动态加载的方式引入了 lodash。那么在 async 模式下，插件在打包时会分离出lodash~for~a.js的 chunk 模块，而 a 和 b 的公共模块 jQuery 并不会被（优化）分离出来，所以它可能还同时存在于打包后的a.bundle.js和b.bundle.js文件中。因为async告诉插件优先考虑的是动态加载的模块")]),s._v(" "),n("h4",{attrs:{id:"webpack-dll"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webpack-dll"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://www.cnblogs.com/skychx/p/webpack-dllplugin.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("webpack dll"),n("OutboundLink")],1)]),s._v(" "),n("h3",{attrs:{id:"项目中-你使用-webpack-做了哪些优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#项目中-你使用-webpack-做了哪些优化"}},[s._v("#")]),s._v(" 项目中，你使用 webpack 做了哪些优化")]),s._v(" "),n("h4",{attrs:{id:"构建速度"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#构建速度"}},[s._v("#")]),s._v(" 构建速度")]),s._v(" "),n("p",[s._v("开发环境编译慢: 需要考虑怎么在开发环境做资源缓存，每一次改动代码，让 rebuild 检查的模块越少越快。\n分析工具：")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("speed-measure-webpack-plugin：分析出 Webpack 打包过程中 Loader 和 Plugin 的耗时，有助于找到构建过程中的性能瓶颈。")])]),s._v(" "),n("li",[n("p",[s._v("webpack-bundle-analyzer：可视化的方式直观地看到打包的bundle中到底包含哪些模块内容，以及每一个模块的体积大小。可以根据这些信息去分析项目结构，调整打包配置，进行优化。")])]),s._v(" "),n("li",[n("ol",[n("li",[s._v("使用 "),n("code",[s._v("happypack")]),s._v("（多进程模型）(它将任务分解给多个子进程去并发执行，子进程处理完后再将结果发给主进程。) 加速构建。v4及以上webpack已使用多线程，没必要使用这个了。在webpack4之后，可以使用thread-loader。"),n("code",[s._v("thread loader")]),s._v("（把这个 loader 放置在其他 loader 之前， 放置在这个 loader 之后的 loader 就会在一个单独的 worker【worker pool】 池里运行，一个worker 就是一个nodeJS 进程【node.js process】，每个单独进程处理时间上限为600ms，各个进程的数据交换也会限制在这个时间内。）")])])]),s._v(" "),n("li",[n("ol",{attrs:{start:"2"}},[n("li",[s._v("利用缓存：利用缓存可以提升二次构建速度。")])]),s._v(" "),n("ul",[n("li",[s._v("a. 在一些性能开销较大的 "),n("code",[s._v("loader")]),s._v(" 之前添加此"),n("code",[s._v("cache-loader")]),s._v("，以将结果缓存到磁盘中。或者babel-loader 的 cacheDirectory， "),n("code",[s._v("loader: 'babel-loader?cacheDirectory=true',")]),s._v("；")]),s._v(" "),n("li",[s._v("b. hard-source-webpack-plugin(webpack 5)")])])]),s._v(" "),n("li",[n("ol",{attrs:{start:"3"}},[n("li",[s._v("缩小打包作用域：")])]),s._v(" "),n("ul",[n("li",[s._v("exclude/include （确定 loader 规则范围）")]),s._v(" "),n("li",[s._v("resolve.modules 指明第三方模块的绝对路径（减少不必要的查找）")]),s._v(" "),n("li",[s._v("resolve.extensions 尽可能减少后缀尝试的可能性")]),s._v(" "),n("li",[s._v("noParse 对完全不需要解析的库进行忽略（不去解析但仍会打包到 bundle 中，注意被忽略掉的文件里不应该包含 import、require、define 等模块化语句）")]),s._v(" "),n("li",[s._v("IgnorePlugin（完全排除模块）")]),s._v(" "),n("li",[s._v("合理使用 alias")])])]),s._v(" "),n("li",[n("ol",{attrs:{start:"4"}},[n("li",[s._v("动态链接库")])]),s._v(" "),n("ul",[n("li",[s._v("a. 使用"),n("code",[s._v("html-webpack-externals-plugin")]),s._v("，公共库和UI库html cdn引入或者"),n("code",[s._v("Externals")])]),s._v(" "),n("li",[s._v("b. "),n("a",{attrs:{href:"https://www.cnblogs.com/skychx/p/webpack-dllplugin.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("dll Plugin"),n("OutboundLink")],1),s._v("（把每次打包不需要变动的文件（一般类库，如:react,lodash）提前打包好，这样每次打包项目的时候，就不需要单独打包这些文件，从而节约了时间），先使用"),n("code",[s._v("DllPlugin")]),s._v("打包第三方库，在使用"),n("code",[s._v("DLLReferencePlugin")]),s._v("引用"),n("code",[s._v("manifest.json")]),s._v("，去关联第1步中已经打好的包")])])])]),s._v(" "),n("h4",{attrs:{id:"优化构建体积"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#优化构建体积"}},[s._v("#")]),s._v(" 优化构建体积")]),s._v(" "),n("ul",[n("li",[n("ol",[n("li",[s._v("使用动态import，减小包的体积，路由懒加载，使用webpackChunkName实现更好的分包")])])]),s._v(" "),n("li",[n("ol",{attrs:{start:"2"}},[n("li",[s._v("代码分割：使用"),n("code",[s._v("optimization.splitChunks")]),s._v("，实现更好的打包，如用"),n("code",[s._v("cacheGroups-async")]),s._v("， 实现css文件合并成一个等")])])]),s._v(" "),n("li",[n("ol",{attrs:{start:"3"}},[n("li",[s._v("treeShaking： 使用ES6的"),n("code",[s._v("import/export")]),s._v("语法，并且具名导入导出代码，而不要使用"),n("code",[s._v("export default")]),s._v("。")])])]),s._v(" "),n("li",[n("ol",{attrs:{start:"4"}},[n("li",[s._v("图片压缩( image-webpack-loader)、url-loader图片base64内联，或者雪碧图（postcss-sprites）等")])])]),s._v(" "),n("li",[n("ol",{attrs:{start:"5"}},[n("li",[s._v("代码压缩: "),n("code",[s._v("uglifyjs-webpack-plugin")]),s._v(" 和 "),n("code",[s._v("terser-webpack-plugin")]),s._v("（可以开启多线程压缩）。v4.26.0版本之前，webpack内置的压缩插件是uglifyjs-webpack-plugin，从v4.26.0版本开始，换成了terser-webpack-plugin。")])])])]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" TerserPlugin "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'terser-webpack-plugin'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  optimization"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    minimizer"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("  \n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TerserPlugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        parallel"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//开启并行压缩，可以加快构建速度")]),s._v("\n        sourceMap"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//如果生产环境使用source-maps，则必须设置为true")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("ul",[n("li",[n("ol",{attrs:{start:"6"}},[n("li",[s._v("gzip：使用webpack生成gzip文件需要借助compression-webpack-plugin，使用配置如下：")])])])]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" CompressionWebpackPlugin "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"compression-webpack-plugin"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  plugins"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CompressionWebpackPlugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n       test"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("\\.(js|css)$")]),n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//匹配要压缩的文件")]),s._v("\n       algorithm"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gzip"')]),s._v("\n     "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("ul",[n("li",[n("a",{attrs:{href:"https://juejin.cn/post/6953790342613172237",target:"_blank",rel:"noopener noreferrer"}},[s._v("一文搞定webpack构建优化策略"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/150731200",target:"_blank",rel:"noopener noreferrer"}},[s._v("关于webpack性能调优"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/137120584",target:"_blank",rel:"noopener noreferrer"}},[s._v("vue模块化按需编译，突破编译瓶颈"),n("OutboundLink")],1)])]),s._v(" "),n("h3",{attrs:{id:"编写loader"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#编写loader"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://v4.webpack.docschina.org/contribute/writing-a-loader/",target:"_blank",rel:"noopener noreferrer"}},[s._v("编写loader"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("编写 loader 时应该遵循以下准则")]),s._v(" "),n("ul",[n("li",[s._v("简单易用: loaders 应该只做单一任务。这不仅使每个 loader 易维护，也可以在更多场景链式调用。")]),s._v(" "),n("li",[s._v("使用链式传递: 利用 loader 可以链式调用的优势。写五个简单的 loader 实现五项任务，而不是一个 loader 实现五项任务。")]),s._v(" "),n("li",[s._v("模块化的输出。保证输出模块化。loader 生成的模块与普通模块遵循相同的设计原则。")]),s._v(" "),n("li",[s._v("确保无状态。确保 "),n("code",[s._v("loader")]),s._v(" 在不同模块转换之间不保存状态。每次运行都应该独立于其他编译模块以及相同模块之前的编译结果。")])]),s._v(" "),n("p",[s._v("loader 其实就是一个 function，接收一个参数 source，就是当前的文件内容，然后稍加处理，就可以 return 出一个新的文件内容。")]),s._v(" "),n("p",[s._v("example: 处理 .txt 文件，并且将任何实例中的 "),n("code",[s._v("[name]")]),s._v(" 直接替换为 loader 选项中设置的 name。然后返回包含默认导出文本的 JavaScript 模块。")]),s._v(" "),n("details",{staticClass:"custom-block details"},[n("summary",[s._v("点击查看代码")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" getOptions "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'loader-utils'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("loader")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("source")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" options "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getOptions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  source "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("replace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("\\[name\\]")]),n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-flags"}},[s._v("g")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("export default ")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("stringify")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 使用")]),s._v("\nmodule"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      rules"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        test"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("\\.txt$")]),n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        use"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          loader"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'../config/loader.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          options"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Alice'")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])])]),s._v(" "),n("p",[s._v("异步调用")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("exports")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("source")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" callback "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("async")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 由于有 3 秒延迟，所以打包时需要 3+ 秒的时间")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setTimeout")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("callback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("replace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-flags"}},[s._v("g")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("异步 "),n("code",[s._v("loader")]),s._v(" 需要调用 webpack 的 "),n("code",[s._v("async()")]),s._v(" 生成一个"),n("code",[s._v("callback")]),s._v("，它的第一个参数是 error，这里可设为 null，第二个参数就是处理后的源码。当你异步处理完源码后，调用 callback 即可。")]),s._v(" "),n("h3",{attrs:{id:"编写插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#编写插件"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://v4.webpack.docschina.org/contribute/writing-a-plugin/",target:"_blank",rel:"noopener noreferrer"}},[s._v("编写插件"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("Compiler 和 Compilation")]),s._v(" "),n("p",[s._v("在插件开发中最重要的两个资源就是 compiler 和 compilation 对象。理解它们的角色是扩展 webpack 引擎重要的第一步。\ncompiler 对象代表了完整的 webpack 环境配置。这个对象在启动 webpack 时被一次性建立，并配置好所有可操作的设置，包括 options，loader 和 plugin。当在 webpack 环境中应用一个插件时，插件将收到此 compiler 对象的引用。可以使用它来访问 webpack 的主环境。\ncompilation 对象代表了一次资源版本构建。当运行 webpack 开发环境中间件时，每当检测到一个文件变化，就会创建一个新的 compilation，从而生成一组新的编译资源。一个 compilation 对象表现了当前的模块资源、编译生成资源、变化的文件、以及被跟踪依赖的状态信息。compilation 对象也提供了很多关键时机的回调，以供插件做自定义处理时选择使用。")]),s._v(" "),n("p",[s._v("一个插件由以下构成")]),s._v(" "),n("ul",[n("li",[s._v("一个具名 JavaScript 函数。")]),s._v(" "),n("li",[s._v("在它的原型上定义 apply 方法。")]),s._v(" "),n("li",[s._v("指定一个触及到 webpack 本身的 事件钩子。")]),s._v(" "),n("li",[s._v("操作 webpack 内部的实例特定数据。")]),s._v(" "),n("li",[s._v("在实现功能后调用 webpack 提供的 callback。")])]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FileListPlugin")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("apply")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("compiler")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// emit 是异步 hook，使用 tapAsync 触及它，还可以使用 tapPromise/tap(同步)")]),s._v("\n    compiler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hooks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("emit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tapAsync")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'FileListPlugin'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("compilation"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" callback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在生成文件中，创建一个头部字符串：")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" filelist "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'In this build:\\n\\n'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 遍历所有编译过的资源文件，")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 对于每个文件名称，都添加一行内容。")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" filename "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" compilation"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("assets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        filelist "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'- '")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" filename "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\n'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 将这个列表作为一个新的文件资源，插入到 webpack 构建中：")]),s._v("\n      compilation"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("assets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'filelist.md'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("source")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" filelist"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("size")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" filelist"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("callback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" FileListPlugin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br")])]),n("h3",{attrs:{id:"tree-shaking"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tree-shaking"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://webpack.docschina.org/guides/tree-shaking",target:"_blank",rel:"noopener noreferrer"}},[s._v("Tree Shaking"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("Tree shaking 是一种通过清除多余代码方式来优化项目打包体积的技术，专业术语叫 Dead code elimination")]),s._v(" "),n("p",[s._v("必须使用 ES2015 模块语法。是基于esm 静态分析来的，而"),n("code",[s._v("require()")]),s._v("语法的 "),n("code",[s._v("CommonJS")]),s._v(" 模块规范。这些模块是 "),n("code",[s._v("dynamic")]),s._v(" 动态加载的，这意味着可以根据代码中的条件导入新模块。")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" myDynamicModule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("condition"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    myDynamicModule "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"foo"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    myDynamicModule "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bar"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("CommonJS 模块的这种 dynamic 性质意味着无法应用 Tree Shaking，因为在实际运行代码之前无法确定需要哪些模块。")]),s._v(" "),n("p",[s._v("Tree Shaking: 顾名思义，把代码比作一棵树，把树上已经烂掉的果子比喻成不需要的代码，通过摇晃树的方式把烂掉的果子抖下来。")]),s._v(" "),n("p",[s._v("Tree Shaking 是 ES2015 模块定义中的一个功能。它的核心点在于，在不运行模块的情况下静态地分析模块，使得 Webpack 发现哪些部分的代码正在使用，而哪些代码没有被使用。")]),s._v(" "),n("p",[s._v("其实tree-shaking的消除原理是依赖于ES6的模块特性。")]),s._v(" "),n("p",[s._v("ES6 module 特点：")]),s._v(" "),n("ol",[n("li",[s._v("只能作为模块顶层的语句出现")]),s._v(" "),n("li",[s._v("import 的模块名只能是字符串常量")]),s._v(" "),n("li",[s._v("import binding 是 immutable的")])]),s._v(" "),n("p",[n("strong",[s._v("ES6模块依赖关系是确定的，和运行时的状态无关，可以进行可靠的静态分析")]),s._v(",")]),s._v(" "),n("h3",{attrs:{id:"webpack模块打包原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webpack模块打包原理"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://juejin.cn/post/6844903802382860296",target:"_blank",rel:"noopener noreferrer"}},[s._v("Webpack模块打包原理"),n("OutboundLink")],1)]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/243485307",target:"_blank",rel:"noopener noreferrer"}},[s._v("模块加载"),n("OutboundLink")],1),s._v("\nwebpack根据"),n("code",[s._v("webpack.config.js")]),s._v("中的入口文件，在入口文件里识别模块依赖，不管这里的模块依赖是用"),n("code",[s._v("CommonJS")]),s._v("写的，还是"),n("code",[s._v("ES6 Module")]),s._v("规范写的，webpack会自动进行分析，并通过转换、编译代码，打包成最终的文件。最终文件中的模块实现是基于webpack自己实现的"),n("code",[s._v("webpack_require")]),s._v("（es5代码），所以打包后的文件可以跑在浏览器上。")])]),s._v(" "),n("p",[s._v("使用一个立即执行函数，实现了类似Common Js require和exports的特性，核心是"),n("code",[s._v("__webpack_require__")]),s._v("的实现，\n创建模块缓存"),n("code",[s._v("installedModules")]),s._v("，从入口文件执行require。")]),s._v(" "),n("p",[s._v("懒加载是动态创建jsonp的动态script标签，加载异步模块，加载完成"),n("code",[s._v('window["webpackJsonp"]')]),s._v(" push模块，异步模块打包后的文件中保存着异步模块源代码，同时为了区分不同的异步模块，还保存着该异步模块对应的标识：chunkId。")]),s._v(" "),n("p",[s._v("webpack实现模块的异步加载有点像jsonp的流程。在主js文件中通过在head中构建script标签方式，异步加载模块信息；再使用回调函数webpackJsonpCallback，把异步的模块源码同步到主文件中，所以后续操作异步模块可以像同步模块一样。")]),s._v(" "),n("ol",[n("li",[s._v("到异步模块时，使用__webpack_require__.e函数去把异步代码加载进来。该函数会在html的head中动态增加script标签，src指向指定的异步模块存放的文件。")]),s._v(" "),n("li",[s._v("加载的异步模块文件会执行webpackJsonpCallback函数，把异步模块加载到主文件中。")]),s._v(" "),n("li",[s._v('所以后续可以像同步模块一样,直接使用__webpack_require__("./src/async.js")加载异步模块。')])]),s._v(" "),n("p",[s._v("源码中的"),n("code",[s._v("primose")]),s._v("使用非常精妙，主模块加载完成异步模块才resolve()")]),s._v(" "),n("details",{staticClass:"custom-block details"},[n("summary",[s._v("点击查看代码")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 0.bundle.js")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 异步模块")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// window["webpackJsonp"]是连接多个chunk文件的桥梁')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// window["webpackJsonp"].push = 主chunk文件.webpackJsonpCallback')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"webpackJsonp"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"webpackJsonp"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 异步模块标识chunkId,可判断异步代码是否加载成功")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 跟同步模块一样，存放了{模块路径：模块内容}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./src/async.js"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" __webpack_exports__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" __webpack_require__")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      __webpack_require__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("r")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__webpack_exports__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      __webpack_exports__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hello, aysnc module'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// webpack.config.js")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" path "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'path'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    mode"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'development'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// JavaScript 执行入口文件")]),s._v("\n  entry"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./src/main.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  output"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 把所有依赖的模块合并输出到一个 bundle.js 文件")]),s._v("\n    filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'bundle.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 输出文件都放到 dist 目录下")]),s._v("\n    path"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./dist'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// src/add")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" b")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" name "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hello world,'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 这里特意使用了ES6语法")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" a "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" b\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// src/main.js")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Add "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./add'")]),s._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[s._v("build.js")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// modules是存放所有模块的数组，数组中每个元素存储{ 模块路径: 模块导出代码函数 }")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("modules")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 模块缓存作用，已加载的模块可以不用再重新读取，提升性能")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" installedModules "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 关键函数，加载模块代码")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 形式有点像Node的CommonJS模块，但这里是可跑在浏览器上的es5代码")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("__webpack_require__")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("moduleId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 缓存检查，有则直接从缓存中取得")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("installedModules"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("moduleId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" installedModules"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("moduleId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 先创建一个空模块，塞入缓存中")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" module "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" installedModules"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("moduleId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    i"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" moduleId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    l"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 标记是否已经加载")]),s._v("\n    exports"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 初始模块为空")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 把要加载的模块内容，挂载到module.exports上")]),s._v("\n  modules"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("moduleId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("call")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" __webpack_require__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("l "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 标记为已加载")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 返回加载的模块，调用方直接调用即可")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// __webpack_require__对象下的r函数")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在module.exports上定义__esModule为true，表明是一个模块对象")]),s._v("\n__webpack_require__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("r")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("exports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("defineProperty")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("exports"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'__esModule'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" value"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 启动入口模块main.js")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("__webpack_require__")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__webpack_require__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("s "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./src/main.js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// add模块")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./src/add.js"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" __webpack_exports__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" __webpack_require__")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在module.exports上定义__esModule为true")]),s._v("\n    __webpack_require__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("r")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__webpack_exports__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 直接把add模块内容，赋给module.exports.default对象上")]),s._v("\n    __webpack_exports__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" b")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" name "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hello world,'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" a "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" b\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 入口模块")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./src/main.js"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" __webpack_exports__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" __webpack_require__")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    __webpack_require__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("r")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__webpack_exports__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 拿到add模块的定义")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// _add__WEBPACK_IMPORTED_MODULE_0__ = module.exports，有点类似require")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" _add__WEBPACK_IMPORTED_MODULE_0__ "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("__webpack_require__")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./src/add.js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// add模块内容: _add__WEBPACK_IMPORTED_MODULE_0__["default"]')]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("_add__WEBPACK_IMPORTED_MODULE_0__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Object")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("_add__WEBPACK_IMPORTED_MODULE_0__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br")])])]),s._v(" "),n("h3",{attrs:{id:"require-context是什么"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#require-context是什么"}},[s._v("#")]),s._v(" require.context是什么")]),s._v(" "),n("p",[s._v("一个webpack的api，通过执行"),n("code",[s._v("require.context")]),s._v("函数获取一个特定的上下文，主要用来实现自动化导入模块，在前端工程中，如果遇到从一个文件夹引入很多模块的情况，\n可以使用这个api，它会遍历文件夹中的指定文件，然后自动导入，使得不需要每次显式的调用"),n("code",[s._v("import")]),s._v("导入模块。比如在Vue中使用"),n("code",[s._v("require.context")]),s._v("函数遍历modules文件夹的所有文件一次性导入到index.js中")]),s._v(" "),n("blockquote",[n("p",[s._v("语法: "),n("code",[s._v("require.context(directory, useSubdirectories = false, regExp = /^.//);")]),s._v("\nrequire.context函数接受三个参数")])]),s._v(" "),n("ol",[n("li",[n("p",[s._v("directory {String} -读取文件的路径")])]),s._v(" "),n("li",[n("p",[s._v("useSubdirectories {Boolean} -是否遍历文件的子目录")])]),s._v(" "),n("li",[n("p",[s._v("regExp {RegExp} -匹配文件的正则")])])]),s._v(" "),n("h3",{attrs:{id:"sourcemap"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sourcemap"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://mp.weixin.qq.com/s/87VqGBaT9aF1B1Tokr4CKQ",target:"_blank",rel:"noopener noreferrer"}},[s._v("SourceMap"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("sourceMap可以帮我们直接定位到编译前代码的特定位置。")]),s._v(" "),n("p",[s._v("sourceMap其实就是就是一段维护了前后代码映射关系的json描述文件，包含了以下一些信息：")]),s._v(" "),n("ul",[n("li",[s._v("version：sourcemap版本（现在都是v3）")]),s._v(" "),n("li",[s._v("file：转换后的文件名。")]),s._v(" "),n("li",[s._v("sourceRoot：转换前的文件所在的目录。如果与转换前的文件在同一目录，该项为空。")]),s._v(" "),n("li",[s._v("sources：转换前的文件。该项是一个数组，表示可能存在多个文件合并。")]),s._v(" "),n("li",[s._v("names：转换前的所有变量名和属性名。")]),s._v(" "),n("li",[s._v("mappings：记录位置信息的字符串。mappings 信息是关键，它使用Base64 VLQ 编码，包含了源代码与生成代码的位置映射信息。")])])])}),[],!1,null,null,null);t.default=e.exports}}]);