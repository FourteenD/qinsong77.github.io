(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{554:function(e,t,r){"use strict";r.r(t);var n=r(25),o=Object(n.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h3",{attrs:{id:"nest-js"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#nest-js"}},[e._v("#")]),e._v(" Nest.js")]),e._v(" "),r("blockquote",[r("p",[r("a",{attrs:{href:"https://docs.nestjs.cn/",target:"_blank",rel:"noopener noreferrer"}},[e._v("中文网"),r("OutboundLink")],1)])]),e._v(" "),r("h3",{attrs:{id:"v8"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#v8"}},[e._v("#")]),e._v(" v8")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/27628685",target:"_blank",rel:"noopener noreferrer"}},[e._v("认识 V8 引擎"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://juejin.cn/post/6844904137792962567",target:"_blank",rel:"noopener noreferrer"}},[e._v("V8引擎详解"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/26169639",target:"_blank",rel:"noopener noreferrer"}},[e._v("从Chrome源码看JS Object的实现"),r("OutboundLink")],1)])]),e._v(" "),r("h3",{attrs:{id:"一篇文章构建你的-nodejs-知识体系"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#一篇文章构建你的-nodejs-知识体系"}},[e._v("#")]),e._v(" "),r("a",{attrs:{href:"https://juejin.cn/post/6844903767926636558",target:"_blank",rel:"noopener noreferrer"}},[e._v("一篇文章构建你的 NodeJS 知识体系"),r("OutboundLink")],1)]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://mp.weixin.qq.com/s/6LsPMIHdIOw3KO6F2sgRXg",target:"_blank",rel:"noopener noreferrer"}},[e._v("Node.js 并发能力总结"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://mp.weixin.qq.com/s/lcoa6X-aSaUJHzdXFEjuzA",target:"_blank",rel:"noopener noreferrer"}},[e._v("MongoDB 极简入门实践"),r("OutboundLink")],1)])]),e._v(" "),r("h3",{attrs:{id:"cookie、session、token、jwt"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#cookie、session、token、jwt"}},[e._v("#")]),e._v(" "),r("a",{attrs:{href:"https://juejin.im/post/6844904034181070861",target:"_blank",rel:"noopener noreferrer"}},[e._v("Cookie、Session、Token、JWT"),r("OutboundLink")],1)]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("JSON Web Token 入门教程"),r("OutboundLink")],1)])]),e._v(" "),r("p",[e._v("简单token的组成： uid(用户唯一的身份标识)、time(当前时间的时间戳)、sign（签名，token 的前几位以哈希算法压缩成的一定长度的十六进制字符串）")]),e._v(" "),r("p",[e._v("JWT 的三个部分依次如下。")]),e._v(" "),r("ul",[r("li",[e._v("Header（头部）")]),e._v(" "),r("li",[e._v("Payload（负载）")]),e._v(" "),r("li",[e._v("Signature（签名）")])]),e._v(" "),r("p",[e._v("Token 和 JWT 的区别")]),e._v(" "),r("p",[e._v("相同：")]),e._v(" "),r("ul",[r("li",[r("p",[e._v("都是访问资源的令牌")])]),e._v(" "),r("li",[r("p",[e._v("都可以记录用户的信息")])]),e._v(" "),r("li",[r("p",[e._v("都是使服务端无状态化")])]),e._v(" "),r("li",[r("p",[e._v("都是只有验证成功后，客户端才能访问服务端上受保护的资源\n区别：")])]),e._v(" "),r("li",[r("p",[e._v("Token：服务端验证客户端发送过来的 Token 时，还需要查询数据库获取用户信息，然后验证 Token 是否有效。")])]),e._v(" "),r("li",[r("p",[e._v("JWT： 将 Token 和 Payload 加密后存储于客户端，服务端只需要使用密钥解密进行校验（校验也是 JWT 自己实现的）即可，不需要查询或者减少查询数据库，因为 JWT 自包含了用户信息和加密的数据。")])])]),e._v(" "),r("p",[e._v("两种Token：")]),e._v(" "),r("ol",[r("li",[e._v("去中心化的JWT token")])]),e._v(" "),r("ul",[r("li",[e._v("优点：")])]),e._v(" "),r("ol",[r("li",[e._v("去中心化，便于分布式系统使用")]),e._v(" "),r("li",[e._v("基本信息可以直接放在token中。 username，nickname，role")]),e._v(" "),r("li",[e._v("功能权限信息可以直接放在token中。用bit位表示用户所具有的功能权限。")])]),e._v(" "),r("ul",[r("li",[e._v("缺点：服务端无法主动让token失效")])]),e._v(" "),r("ol",{attrs:{start:"2"}},[r("li",[e._v("中心化的 redis token / memory session等")])]),e._v(" "),r("ul",[r("li",[e._v("优点：服务端可以主动让token失效")]),e._v(" "),r("li",[e._v("缺点：每次都要进行redis查询。占用redis存储空间。")])]),e._v(" "),r("ol",{attrs:{start:"3"}},[r("li",[e._v("优化方案：")])]),e._v(" "),r("p",[e._v("3.1 Jwt Token中，增加TokenId字段。\n3.2 将TokenId字段存储在redis中，用来让服务端可以主动控制token失效\n3.3 牺牲了JWT去中心化的特点。\n3.4 使用非对称加密。颁发token的认证服务器存储私钥：私钥生成签名。其他业务系统存储公钥：公钥验证签名。")]),e._v(" "),r("p",[e._v("方案2和3.2的区别：")]),e._v(" "),r("p",[e._v("方案2：redis存储的是token的"),r("strong",[e._v("白名单")]),e._v("。用户的其他信息也要放在redis中存储。需要占用较大的redis空间和查询次数。")]),e._v(" "),r("p",[e._v("方案3.2 ：这里的redis只存储tokenId的黑名单，同时redis也可以分布式部署，读写分离。token认证服务器操作redis的master，其他redis同步master的数据")]),e._v(" "),r("h4",{attrs:{id:"基本知识点"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#基本知识点"}},[e._v("#")]),e._v(" 基本知识点")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("__dirname")]),e._v(": 总是返回被执行的 js 所在文件夹的绝对路径;")]),e._v(" "),r("li",[r("code",[e._v("__filename")]),e._v(": 总是返回被执行的 js 的绝对路径;")]),e._v(" "),r("li",[r("code",[e._v("process.cwd()")]),e._v(": 总是返回运行 node 命令时所在的文件夹的绝对路径;")]),e._v(" "),r("li",[r("code",[e._v("path.dirname()")]),e._v("： 返回 path 的目录名")]),e._v(" "),r("li",[r("code",[e._v("path.join()")]),e._v("：所有给定的 path 片段连接到一起，然后规范化生成的路径")]),e._v(" "),r("li",[r("code",[e._v("path.resolve()")]),e._v("：方法会将路径或路径片段的序列解析为绝对路径，解析为相对于当前目录的绝对路径，相当于cd命令")])])])}),[],!1,null,null,null);t.default=o.exports}}]);